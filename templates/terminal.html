{% extends "layout.html" %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Command Terminal</h1>
    
    <!-- Terminal Card -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-dark d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0 text-light">VPN Command Terminal</h5>
                    <div>
                        <button class="btn btn-sm btn-outline-light" id="clearTerminalBtn">
                            <i class="fas fa-trash-alt me-1"></i> Clear
                        </button>
                    </div>
                </div>
                <div class="card-body bg-dark">
                    <div id="terminal" class="terminal-container p-3 mb-3" style="height: 400px; overflow-y: auto; font-family: monospace; background-color: #1e1e1e; color: #f0f0f0; border-radius: 4px;">
                        <div class="terminal-welcome">
                            <p class="text-success">Welcome to VPN Tunnel Terminal</p>
                            <p>Type 'help' to see a list of available commands.</p>
                        </div>
                        <div id="terminal-output"></div>
                    </div>
                    <div class="input-group">
                        <span class="input-group-text bg-dark text-light border-secondary">$</span>
                        <input type="text" id="commandInput" class="form-control bg-dark text-light border-secondary" placeholder="Enter command...">
                        <button class="btn btn-outline-primary" type="button" id="runCommandBtn">Run</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Command Documentation -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-transparent">
                    <h5 class="mb-0">Command Documentation</h5>
                </div>
                <div class="card-body">
                    <div class="accordion" id="commandAccordion">
                        <!-- WireGuard Setup Commands -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    WireGuard Setup Commands
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#commandAccordion">
                                <div class="accordion-body">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Command</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><code>wg-keygen</code></td>
                                                <td>Generate a new WireGuard key pair (private and public keys)</td>
                                            </tr>
                                            <tr>
                                                <td><code>wg-status</code></td>
                                                <td>Check the current status of the WireGuard tunnel</td>
                                            </tr>
                                            <tr>
                                                <td><code>wg-start</code></td>
                                                <td>Start the WireGuard tunnel</td>
                                            </tr>
                                            <tr>
                                                <td><code>wg-stop</code></td>
                                                <td>Stop the WireGuard tunnel</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Network Diagnostic Commands -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingTwo">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                    Network Diagnostic Commands
                                </button>
                            </h2>
                            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#commandAccordion">
                                <div class="accordion-body">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Command</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><code>ping-test &lt;host&gt;</code></td>
                                                <td>Ping a host to check connectivity and latency</td>
                                            </tr>
                                            <tr>
                                                <td><code>speed-test</code></td>
                                                <td>Run a speed test to measure current connection speeds</td>
                                            </tr>
                                            <tr>
                                                <td><code>trace-route &lt;host&gt;</code></td>
                                                <td>Trace the network route to a destination</td>
                                            </tr>
                                            <tr>
                                                <td><code>show-routes</code></td>
                                                <td>Show current routing table</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Configuration Commands -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingThree">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                    Configuration Commands
                                </button>
                            </h2>
                            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#commandAccordion">
                                <div class="accordion-body">
                                    <table class="table table-striped">
                                        <thead>
                                            <tr>
                                                <th>Command</th>
                                                <th>Description</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><code>config-get</code></td>
                                                <td>Show the current WireGuard configuration</td>
                                            </tr>
                                            <tr>
                                                <td><code>config-set &lt;key&gt; &lt;value&gt;</code></td>
                                                <td>Set a configuration value</td>
                                            </tr>
                                            <tr>
                                                <td><code>config-reset</code></td>
                                                <td>Reset configuration to defaults</td>
                                            </tr>
                                            <tr>
                                                <td><code>show-logs</code></td>
                                                <td>Show recent log entries</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- AWS Setup Guide -->
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingFour">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                    AWS Setup Guide
                                </button>
                            </h2>
                            <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#commandAccordion">
                                <div class="accordion-body">
                                    <p>To set up WireGuard on your AWS EC2 instance, run these commands on your AWS server:</p>
                                    
                                    <div class="mb-3">
                                        <h6>1. Install WireGuard</h6>
                                        <pre class="bg-dark text-light p-3 rounded"><code>sudo apt update
sudo apt install -y wireguard</code></pre>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>2. Generate Key Pair</h6>
                                        <pre class="bg-dark text-light p-3 rounded"><code>wg genkey | tee privatekey | wg pubkey > publickey
sudo chmod 600 privatekey</code></pre>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>3. Create Configuration File</h6>
                                        <pre class="bg-dark text-light p-3 rounded"><code>sudo nano /etc/wireguard/wg0.conf</code></pre>
                                        
                                        <p class="mt-2">Add the following content:</p>
                                        <pre class="bg-dark text-light p-3 rounded"><code>[Interface]
PrivateKey = YOUR_SERVER_PRIVATE_KEY
Address = 10.0.0.1/24
ListenPort = 51820
PostUp = iptables -A FORWARD -i wg0 -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i wg0 -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

[Peer]
PublicKey = YOUR_LOCAL_PUBLIC_KEY
AllowedIPs = 10.0.0.2/32</code></pre>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>4. Enable IP Forwarding</h6>
                                        <pre class="bg-dark text-light p-3 rounded"><code>echo "net.ipv4.ip_forward=1" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p</code></pre>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <h6>5. Start WireGuard</h6>
                                        <pre class="bg-dark text-light p-3 rounded"><code>sudo systemctl enable wg-quick@wg0
sudo systemctl start wg-quick@wg0</code></pre>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/terminal.js"></script>
{% endblock %}